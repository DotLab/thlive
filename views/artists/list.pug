extends ../base

include ../mixin/alert

block main
	div.pt-4.container
		form.form-inline.float-right.hidden-xs-down
			div.input-group.input-group-sm
				input.form-control(type='text', placeholder='Search artist...')
				span.input-group-btn
					button.btn.btn-primary(type='button')
						i.fa.fa-search
		h2.h4 Find your favorite artists!
		p.text-muted After you follow a user, you can view their new submissions easily through Home! You can also view their activity through the Feed page, such as their bookmarks, making it easy to find pictures you might also like!

		hr

		ul#artist_container.list-unstyled
			//- for artist in artists
			//- 	li.media.mb-2
			//- 		img.d-flex.mr-3.height-128.rounded(src='/res/img/cf196545bc8a0d42dc9d2e26c91c324fd7e9b694.png')
			//- 		div.media-body
			//- 			h5.mt-0.mb-1 #[span #{artist.name}] #[small.text-muted.hidden-xs-down - #{artist._id}]
			//- 			span ※転載する場合は私の名前を明記してください。転載許可は不要です。

			//- 		a.hidden-xs-down(href='/')
			//- 			img.d-flex.ml-3.height-128.rounded(src='/res/img/cf196545bc8a0d42dc9d2e26c91c324fd7e9b694.png')
			//- 		a.hidden-sm-down(href='/')
			//- 			img.d-flex.height-128.rounded(src='/res/img/cf196545bc8a0d42dc9d2e26c91c324fd7e9b694.png')
			//- 		a.hidden-md-down(href='/')
			//- 			img.d-flex.height-128.rounded(src='/res/img/cf196545bc8a0d42dc9d2e26c91c324fd7e9b694.png')
			//- 		a.hidden-lg-down(href='/')
			//- 			img.d-flex.height-128.rounded(src='/res/img/cf196545bc8a0d42dc9d2e26c91c324fd7e9b694.png')

block foot
	script#template(type="text/x-jsrender")
		li.media
			a(href='{{: href}}')
				img.d-flex.mr-3.height-100.rounded.lazy(data-original='{{: avatar_src}}')
			div.media-body.small
				h5.mt-0.mb-1 #{'{{: name}}'} #[small.text-muted.hidden-xs-down - #{'{{: id}}'}]
				div Illustrations: #{'{{: count_images}}'}
				a(href='{{: homepage}}') #{'{{: homepage}}'}
				div #{'{{: intro}}'}

			a.hidden-xs-down(href='{{: hero_0_href}}')
				img.d-flex.ml-3.height-100.lazy(data-original='{{: hero_0_src}}')
			a.hidden-sm-down(href='{{: hero_1_href}}')
				img.d-flex.height-100.lazy(data-original='{{: hero_1_src}}')
			a.hidden-sm-down(href='{{: hero_2_href}}')
				img.d-flex.height-100.lazy(data-original='{{: hero_2_src}}')
			a.hidden-md-down(href='{{: hero_3_href}}')
				img.d-flex.height-100.lazy(data-original='{{: hero_3_src}}')
		hr

	script(src='https://cdnjs.cloudflare.com/ajax/libs/jsrender/1.0.0-rc.70/jsrender.min.js')
	script(src='https://cdnjs.cloudflare.com/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js')

	script.
		$template = $.templates('#template');
		$container = $('#artist_container');

		limit = 10;
		skip = 0;

		$(function () {
			$.getJSON('/api/artists/list', {
				limit: limit,
				skip: skip
			}).then(docs => {
				console.log(docs);
				$($template.render(docs)).appendTo($container).find('img.lazy').lazyload({
					effect : "fadeIn",
					skip_invisible : true
				});
			});
		});